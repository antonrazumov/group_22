SQL HomeWork 2. Joins
подключится к
Host: 159.69.151.133
Port: 5056
DB: qa_db_2
User: user_22_x
Pass: 123

1.‚ûâåñòè âñåõ ðàáîòíèêîâ ÷üè çàðïëàòû åñòü â áàçå, âìåñòå ñ çàðïëàòàìè. 

select employees.employee_name, employees_salary.monthly_salary 
from employees
join employees_salary
on employees.id =employees_salary.employee_id;

2.‚ûâåñòè âñåõ ðàáîòíèêîâ ó êîòîðûõ ÇÏ ìåíüøå 2000. 

select employees.employee_name, employees_salary.monthly_salary 
from employees
join employees_salary
on employees.id =employees_salary.employee_id
where employees_salary.monthly_salary<2000;

3.‚ûâåñòè âñå çàðïëàòíûå ïîçèöèè, íî ðàáîòíèê ïî íèì íå íàçíà÷åí. (ÇÏ åñòü, íî íå ïîíÿòíî êòî å¸ ïîëó÷àåò.) 

select employees_salary.monthly_salary 
from employees
full join employees_salary
on employees.id =employees_salary.employee_id
where  employees.employee_name is null;

4.‚ûâåñòè âñå çàðïëàòíûå ïîçèöèè  ìåíüøå 2000 íî ðàáîòíèê ïî íèì íå íàçíà÷åí. (ÇÏ åñòü, íî íå ïîíÿòíî êòî å¸ ïîëó÷àåò.) 

select employees_salary.monthly_salary 
from employees
full join employees_salary
on employees.id =employees_salary.employee_id
where  employees.employee_name is null
and employees_salary.monthly_salary<2000;
 
5.àéòè âñåõ ðàáîòíèêîâ êîìó íå íà÷èñëåíà ÇÏ. 

select employees.employee_name  
from employees
full join employees_salary
on employees.id =employees_salary.employee_id
where employees_salary.monthly_salary is null;
 
6.‚ûâåñòè âñåõ ðàáîòíèêîâ ñ íàçâàíèÿìè èõ äîëæíîñòè. 

select employees.employee_name,role_name 
from roles_employees 
join employees 
on roles_employees.employee_id = employees.id 
join roles
on roles_employees.role_id =roles.id;

7.‚ûâåñòè èìåíà è äîëæíîñòü òîëüêî Java ðàçðàáîò÷èêîâ. 

select employees.employee_name,role_name 
from roles_employees 
join employees 
on roles_employees.employee_id = employees.id 
join roles
on roles_employees.role_id =roles.id
where role_name like '%Java %';

8.‚ûâåñòè èìåíà è äîëæíîñòü òîëüêî Python ðàçðàáîò÷èêîâ. 

select employees.employee_name,role_name 
from roles_employees 
join employees 
on roles_employees.employee_id = employees.id 
join roles
on roles_employees.role_id =roles.id
where role_name like '%Python%';
 
9.‚ûâåñòè èìåíà è äîëæíîñòü âñåõ QA èíæåíåðîâ. 

select employees.employee_name,role_name 
from roles_employees 
join employees 
on roles_employees.employee_id = employees.id 
join roles
on roles_employees.role_id =roles.id
where role_name like '%QA%';
 
10.‚ûâåñòè èìåíà è äîëæíîñòü ðó÷íûõ QA èíæåíåðîâ. 

select employees.employee_name,role_name 
from roles_employees 
join employees 
on roles_employees.employee_id = employees.id 
join roles
on roles_employees.role_id =roles.id
where role_name like '%Manual QA%';

11.‚ûâåñòè èìåíà è äîëæíîñòü àâòîìàòèçàòîðîâ QA 

select employees.employee_name,role_name 
from roles_employees 
join employees 
on roles_employees.employee_id = employees.id 
join roles
on roles_employees.role_id =roles.id
where role_name like '%Automation QA%';

12.‚ûâåñòè èìåíà è çàðïëàòû Junior ñïåöèàëèñòîâ

select employees.employee_name,employees_salary.monthly_salary
from employees 
full join employees_salary
on employees_salary.employee_id =employees.id
full join roles_employees
on roles_employees.employee_id =employees.id
join roles 
on role_id=roles.id
where role_name like '%Junior%';

13.‚ûâåñòè èìåíà è çàðïëàòû Middle ñïåöèàëèñòîâ

select employees.employee_name,employees_salary.monthly_salary
from employees 
full join employees_salary
on employees_salary.employee_id =employees.id
full join roles_employees
on roles_employees.employee_id =employees.id
join roles 
on role_id=roles.id
where role_name like '%Middle%';

14.‚ûâåñòè èìåíà è çàðïëàòû Senior ñïåöèàëèñòîâ

select employees.employee_name,employees_salary.monthly_salary
from employees 
full join employees_salary
on employees_salary.employee_id =employees.id
full join roles_employees
on roles_employees.employee_id =employees.id
join roles 
on role_id=roles.id
where role_name like '%Senior%';

15.‚ûâåñòè çàðïëàòû Java ðàçðàáîò÷èêîâ

select monthly_salary, role_name
from employees
join employees_salary
on employees_salary.employee_id = employees.id
join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%Java %';
 
16.‚ûâåñòè çàðïëàòû Python ðàçðàáîò÷èêîâ

select monthly_salary, role_name
from employees
join employees_salary
on employees_salary.employee_id = employees.id
join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%Python%';

17.‚ûâåñòè èìåíà è çàðïëàòû Junior Python ðàçðàáîò÷èêîâ

select employee_name,monthly_salary
from employees
full join employees_salary
on employees_salary.employee_id = employees.id
full join roles_employees
on roles_employees.employee_id = employees.id
full join roles
on role_id = roles.id 
where role_name like '%Junior Python%';

18.‚ûâåñòè èìåíà è çàðïëàòû Middle JS ðàçðàáîò÷èêîâ

select employee_name,monthly_salary
from employees
full join employees_salary
on employees_salary.employee_id = employees.id
full join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%Middle JavaS%';

19.‚ûâåñòè èìåíà è çàðïëàòû Senior Java ðàçðàáîò÷èêîâ

select employee_name,monthly_salary
select employee_name,monthly_salary
from employees
full join employees_salary
on employees_salary.employee_id = employees.id
full join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%Senior%' and role_name like '%Java %';

20.‚ûâåñòè çàðïëàòû Junior QA èíæåíåðîâ

select monthly_salary
from employees
join employees_salary
on employees_salary.employee_id = employees.id
join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%Junior%' and role_name like '%QA%';
 
21.‚ûâåñòè ñðåäíþþ çàðïëàòó âñåõ Junior ñïåöèàëèñòîâ

select avg(monthly_salary)
from employees
join employees_salary
on employees_salary.employee_id = employees.id
join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%Junior%';
 
22.‚ûâåñòè ñóììó çàðïëàò JS ðàçðàáîò÷èêîâ

select sum(monthly_salary)
from employees
join employees_salary
on employees_salary.employee_id = employees.id
join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%JavaScript%';
 
23.‚ûâåñòè ìèíèìàëüíóþ ÇÏ QA èíæåíåðîâ

select min(monthly_salary)
from employees
join employees_salary
on employees_salary.employee_id = employees.id
join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%QA%';
 
24.‚ûâåñòè ìàêñèìàëüíóþ ÇÏ QA èíæåíåðîâ

select max(monthly_salary)
from employees
join employees_salary
on employees_salary.employee_id = employees.id
join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%QA%';
 
25.‚ûâåñòè êîëè÷åñòâî QA èíæåíåðîâ

select count(employee_name)
from employees
full join employees_salary
on employees_salary.employee_id = employees.id
full join roles_employees
on roles_employees.employee_id = employees.id
full join roles
on role_id = roles.id 
where role_name like '%QA%';

26.‚ûâåñòè êîëè÷åñòâî Middle ñïåöèàëèñòîâ.

select count(employee_name)
from employees
full join employees_salary
on employees_salary.employee_id = employees.id
full join roles_employees
on roles_employees.employee_id = employees.id
full join roles
on role_id = roles.id 
where role_name like '%Middle%';

27.‚ûâåñòè êîëè÷åñòâî ðàçðàáîò÷èêîâ

select count(employee_name)
from employees
full join employees_salary
on employees_salary.employee_id = employees.id
full join roles_employees
on roles_employees.employee_id = employees.id
full join roles
on role_id = roles.id 
where role_name like '%developer%';

28.‚ûâåñòè ôîíä (ñóììó) çàðïëàòû ðàçðàáîò÷èêîâ.

select sum(monthly_salary)
from employees
full join employees_salary
on employees_salary.employee_id = employees.id
full join roles_employees
on roles_employees.employee_id = employees.id
full join roles
on role_id = roles.id 
where role_name like '%developer%';
 
29.‚ûâåñòè èìåíà, äîëæíîñòè è ÇÏ âñåõ ñïåöèàëèñòîâ ïî âîçðàñòàíèþ

select employee_name,role_name,monthly_salary
from employees
left join employees_salary
on employees_salary.employee_id = employees.id
left join roles_employees
on roles_employees.employee_id = employees.id
left join roles
on role_id = roles.id 
order by employee_name;
 
30.‚ûâåñòè èìåíà, äîëæíîñòè è ÇÏ âñåõ ñïåöèàëèñòîâ ïî âîçðàñòàíèþ ó ñïåöèàëèñòîâ ó êîòîðûõ ÇÏ îò 1700 äî 2300

select employee_name,role_name,monthly_salary
from employees
left join employees_salary
on employees_salary.employee_id = employees.id
left join roles_employees
on roles_employees.employee_id = employees.id
left join roles
on role_id = roles.id 
where monthly_salary between 1700 and 2300
order by monthly_salary;
 
31.‚ûâåñòè èìåíà, äîëæíîñòè è ÇÏ âñåõ ñïåöèàëèñòîâ ïî âîçðàñòàíèþ ó ñïåöèàëèñòîâ ó êîòîðûõ ÇÏ ìåíüøå 2300

select employee_name,role_name,monthly_salary
from employees
left join employees_salary
on employees_salary.employee_id = employees.id
left join roles_employees
on roles_employees.employee_id = employees.id
left join roles
on role_id = roles.id 
where monthly_salary<2300
order by monthly_salary;
 
32.‚ûâåñòè èìåíà, äîëæíîñòè è ÇÏ âñåõ ñïåöèàëèñòîâ ïî âîçðàñòàíèþ ó ñïåöèàëèñòîâ ó êîòîðûõ ÇÏ ðàâíà 1100, 1500, 2000

select employee_name,role_name,monthly_salary
from employees
left join employees_salary
on employees_salary.employee_id = employees.id
left join roles_employees
on roles_employees.employee_id = employees.id
left join roles
on role_id = roles.id 
where monthly_salary in (1100,1500,2000)
order by monthly_salary;
