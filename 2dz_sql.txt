SQL HomeWork 2. Joins
Подключится к 
Host: 159.69.151.133
Port: 5056
DB: qa_db_2
User: user_22_x
Pass: 123

1.‚ывести всех работников чьи зарплаты есть в базе, вместе с зарплатами. 

select employees.employee_name, employees_salary.monthly_salary 
from employees
join employees_salary
on employees.id =employees_salary.employee_id;

2.‚ывести всех работников у которых ЗП меньше 2000. 

select employees.employee_name, employees_salary.monthly_salary 
from employees
join employees_salary
on employees.id =employees_salary.employee_id
where employees_salary.monthly_salary<2000;

3.‚ывести все зарплатные позиции, но работник по ним не назначен. (ЗП есть, но не понятно кто её получает.) 

select employees_salary.monthly_salary 
from employees
full join employees_salary
on employees.id =employees_salary.employee_id
where  employees.employee_name is null;

4.‚ывести все зарплатные позиции  меньше 2000 но работник по ним не назначен. (ЗП есть, но не понятно кто её получает.) 

select employees_salary.monthly_salary 
from employees
full join employees_salary
on employees.id =employees_salary.employee_id
where  employees.employee_name is null
and employees_salary.monthly_salary<2000;
 
5.Ќайти всех работников кому не начислена ЗП. 

select employees.employee_name  
from employees
full join employees_salary
on employees.id =employees_salary.employee_id
where employees_salary.monthly_salary is null;
 
6.‚ывести всех работников с названиями их должности. 

select employees.employee_name,role_name 
from roles_employees 
join employees 
on roles_employees.employee_id = employees.id 
join roles
on roles_employees.role_id =roles.id;

7.‚ывести имена и должность только Java разработчиков. 

select employees.employee_name,role_name 
from roles_employees 
join employees 
on roles_employees.employee_id = employees.id 
join roles
on roles_employees.role_id =roles.id
where role_name like '%Java %';

8.‚ывести имена и должность только Python разработчиков. 

select employees.employee_name,role_name 
from roles_employees 
join employees 
on roles_employees.employee_id = employees.id 
join roles
on roles_employees.role_id =roles.id
where role_name like '%Python%';
 
9.‚ывести имена и должность всех QA инженеров. 

select employees.employee_name,role_name 
from roles_employees 
join employees 
on roles_employees.employee_id = employees.id 
join roles
on roles_employees.role_id =roles.id
where role_name like '%QA%';
 
10.‚ывести имена и должность ручных QA инженеров. 

select employees.employee_name,role_name 
from roles_employees 
join employees 
on roles_employees.employee_id = employees.id 
join roles
on roles_employees.role_id =roles.id
where role_name like '%Manual QA%';

11.‚ывести имена и должность автоматизаторов QA 

select employees.employee_name,role_name 
from roles_employees 
join employees 
on roles_employees.employee_id = employees.id 
join roles
on roles_employees.role_id =roles.id
where role_name like '%Automation QA%';

12.‚ывести имена и зарплаты Junior специалистов

select employees.employee_name,employees_salary.monthly_salary
from employees 
full join employees_salary
on employees_salary.employee_id =employees.id
full join roles_employees
on roles_employees.employee_id =employees.id
join roles 
on role_id=roles.id
where role_name like '%Junior%';

13.‚ывести имена и зарплаты Middle специалистов

select employees.employee_name,employees_salary.monthly_salary
from employees 
full join employees_salary
on employees_salary.employee_id =employees.id
full join roles_employees
on roles_employees.employee_id =employees.id
join roles 
on role_id=roles.id
where role_name like '%Middle%';

14.‚ывести имена и зарплаты Senior специалистов

select employees.employee_name,employees_salary.monthly_salary
from employees 
full join employees_salary
on employees_salary.employee_id =employees.id
full join roles_employees
on roles_employees.employee_id =employees.id
join roles 
on role_id=roles.id
where role_name like '%Senior%';

15.‚ывести зарплаты Java разработчиков

select monthly_salary, role_name
from employees
join employees_salary
on employees_salary.employee_id = employees.id
join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%Java %';
 
16.‚ывести зарплаты Python разработчиков

select monthly_salary, role_name
from employees
join employees_salary
on employees_salary.employee_id = employees.id
join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%Python%';

17.‚ывести имена и зарплаты Junior Python разработчиков

select employee_name,monthly_salary
from employees
full join employees_salary
on employees_salary.employee_id = employees.id
full join roles_employees
on roles_employees.employee_id = employees.id
full join roles
on role_id = roles.id 
where role_name like '%Junior Python%';

18.‚ывести имена и зарплаты Middle JS разработчиков

select employee_name,monthly_salary
from employees
full join employees_salary
on employees_salary.employee_id = employees.id
full join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%Middle JavaS%';

19.‚ывести имена и зарплаты Senior Java разработчиков

select employee_name,monthly_salary
select employee_name,monthly_salary
from employees
full join employees_salary
on employees_salary.employee_id = employees.id
full join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%Senior%' and role_name like '%Java %';

20.‚ывести зарплаты Junior QA инженеров

select monthly_salary
from employees
join employees_salary
on employees_salary.employee_id = employees.id
join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%Junior%' and role_name like '%QA%';
 
21.‚ывести среднюю зарплату всех Junior специалистов

select avg(monthly_salary)
from employees
join employees_salary
on employees_salary.employee_id = employees.id
join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%Junior%';
 
22.‚ывести сумму зарплат JS разработчиков

select sum(monthly_salary)
from employees
join employees_salary
on employees_salary.employee_id = employees.id
join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%JavaScript%';
 
23.‚ывести минимальную ЗП QA инженеров

select min(monthly_salary)
from employees
join employees_salary
on employees_salary.employee_id = employees.id
join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%QA%';
 
24.‚ывести максимальную ЗП QA инженеров

select max(monthly_salary)
from employees
join employees_salary
on employees_salary.employee_id = employees.id
join roles_employees
on roles_employees.employee_id = employees.id
join roles
on role_id = roles.id 
where role_name like '%QA%';
 
25.‚ывести количество QA инженеров

select count(employee_name)
from employees
full join employees_salary
on employees_salary.employee_id = employees.id
full join roles_employees
on roles_employees.employee_id = employees.id
full join roles
on role_id = roles.id 
where role_name like '%QA%';

26.‚ывести количество Middle специалистов.

select count(employee_name)
from employees
full join employees_salary
on employees_salary.employee_id = employees.id
full join roles_employees
on roles_employees.employee_id = employees.id
full join roles
on role_id = roles.id 
where role_name like '%Middle%';

27.‚ывести количество разработчиков

select count(employee_name)
from employees
full join employees_salary
on employees_salary.employee_id = employees.id
full join roles_employees
on roles_employees.employee_id = employees.id
full join roles
on role_id = roles.id 
where role_name like '%developer%';

28.‚ывести фонд (сумму) зарплаты разработчиков.

select sum(monthly_salary)
from employees
full join employees_salary
on employees_salary.employee_id = employees.id
full join roles_employees
on roles_employees.employee_id = employees.id
full join roles
on role_id = roles.id 
where role_name like '%developer%';
 
29.‚ывести имена, должности и ЗП всех специалистов по возрастанию

select employee_name,role_name,monthly_salary
from employees
left join employees_salary
on employees_salary.employee_id = employees.id
left join roles_employees
on roles_employees.employee_id = employees.id
left join roles
on role_id = roles.id 
order by employee_name;
 
30.‚ывести имена, должности и ЗП всех специалистов по возрастанию у специалистов у которых ЗП от 1700 до 2300

select employee_name,role_name,monthly_salary
from employees
left join employees_salary
on employees_salary.employee_id = employees.id
left join roles_employees
on roles_employees.employee_id = employees.id
left join roles
on role_id = roles.id 
where monthly_salary between 1700 and 2300
order by monthly_salary;
 
31.‚ывести имена, должности и ЗП всех специалистов по возрастанию у специалистов у которых ЗП меньше 2300

select employee_name,role_name,monthly_salary
from employees
left join employees_salary
on employees_salary.employee_id = employees.id
left join roles_employees
on roles_employees.employee_id = employees.id
left join roles
on role_id = roles.id 
where monthly_salary<2300
order by monthly_salary;
 
32.‚ывести имена, должности и ЗП всех специалистов по возрастанию у специалистов у которых ЗП равна 1100, 1500, 2000

select employee_name,role_name,monthly_salary
from employees
left join employees_salary
on employees_salary.employee_id = employees.id
left join roles_employees
on roles_employees.employee_id = employees.id
left join roles
on role_id = roles.id 
where monthly_salary in (1100,1500,2000)
order by monthly_salary;
